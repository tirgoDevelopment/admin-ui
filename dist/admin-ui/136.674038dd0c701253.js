"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[136],{5136:(N,p,a)=>{a.d(p,{d:()=>L});var u=a(8023),r=a(4755),l=a(1728),g=a(430),m=a(3649),x=a(5159),f=a(7579),d=a(2722),e=a(2223),h=a(6567),v=a(5441);const y=["messagesOrigin"],M=["messagesPanel"];function T(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"span",5)(2,"span",6),e._uU(3),e.qZA()(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.hij(" ",t.unreadCount," ")}}function C(n,s){1&n&&e.GkF(0)}function k(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"a",23),e.YNc(2,C,1,0,"ng-container",24),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit,o=e.MAs(10);e.xp6(1),e.Q6J("href",t.link,e.LSH),e.xp6(1),e.Q6J("ngTemplateOutlet",o)}}function b(n,s){1&n&&e.GkF(0)}function Z(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"a",25),e.YNc(2,b,1,0,"ng-container",24),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit,o=e.MAs(10);e.xp6(1),e.Q6J("routerLink",t.link),e.xp6(1),e.Q6J("ngTemplateOutlet",o)}}function A(n,s){if(1&n&&(e.ynx(0),e.YNc(1,k,3,2,"ng-container",2),e.YNc(2,Z,3,2,"ng-container",2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.useRouter),e.xp6(1),e.Q6J("ngIf",t.useRouter)}}function Q(n,s){1&n&&e.GkF(0)}function O(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"div",26),e.YNc(2,Q,1,0,"ng-container",24),e.qZA(),e.BQk()),2&n){e.oxw();const t=e.MAs(10);e.xp6(2),e.Q6J("ngTemplateOutlet",t)}}function E(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"div",29),e._UZ(2,"mat-icon",30),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(2),e.Q6J("svgIcon",t.icon)}}function J(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"img",31),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("src",t.image,e.LSH)("alt","Message image")}}function P(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"div",32),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("innerHTML",t.title,e.oJD)}}function R(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"div",33),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("innerHTML",t.description,e.oJD)}}function I(n,s){if(1&n&&(e.YNc(0,E,3,1,"ng-container",2),e.YNc(1,J,2,2,"ng-container",2),e.TgZ(2,"div",27),e.YNc(3,P,2,1,"ng-container",2),e.YNc(4,R,2,1,"ng-container",2),e.TgZ(5,"div",28),e._uU(6),e.ALo(7,"date"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.Q6J("ngIf",t.icon&&!t.image),e.xp6(1),e.Q6J("ngIf",t.image),e.xp6(2),e.Q6J("ngIf",t.title),e.xp6(1),e.Q6J("ngIf",t.description),e.xp6(2),e.hij(" ",e.xi3(7,5,t.time,"MMM dd, h:mm a")," ")}}const w=function(n){return{unread:n}},U=function(n,s){return{"bg-gray-400 dark:bg-gray-500 sm:opacity-0 sm:group-hover:opacity-100":n,"bg-primary":s}};function B(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16),e.YNc(2,A,3,2,"ng-container",2),e.YNc(3,O,3,1,"ng-container",2),e.TgZ(4,"div",17)(5,"button",18),e.NdJ("click",function(){const _=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.toggleRead(_))}),e._UZ(6,"span",19),e.qZA(),e.TgZ(7,"button",20),e.NdJ("click",function(){const _=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.delete(_))}),e._UZ(8,"mat-icon",21),e.qZA()()(),e.YNc(9,I,8,8,"ng-template",null,22,e.W1O),e.BQk()}if(2&n){const t=s.$implicit;e.xp6(1),e.Q6J("ngClass",e.VKq(7,w,!t.read)),e.xp6(1),e.Q6J("ngIf",t.link),e.xp6(1),e.Q6J("ngIf",!t.link),e.xp6(2),e.Q6J("matTooltip",t.read?"Mark as unread":"Mark as read"),e.xp6(1),e.Q6J("ngClass",e.WLB(9,U,t.read,!t.read)),e.xp6(1),e.Q6J("matTooltip","Remove"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x-mark")}}function D(n,s){1&n&&(e.ynx(0),e.TgZ(1,"div",34)(2,"div",35),e._UZ(3,"mat-icon",36),e.qZA(),e.TgZ(4,"div",37),e._uU(5,"No messages"),e.qZA(),e.TgZ(6,"div",38),e._uU(7,"When you have messages, they will appear here."),e.qZA()(),e.BQk()),2&n&&(e.xp6(3),e.Q6J("svgIcon","heroicons_outline:inbox"))}function Y(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"div",9)(3,"button",0),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closePanel())}),e._UZ(4,"mat-icon",10),e.qZA()(),e.TgZ(5,"div",11),e._uU(6,"Messages"),e.qZA(),e.TgZ(7,"div",12)(8,"button",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.markAllAsRead())}),e._UZ(9,"mat-icon",10),e.qZA()()(),e.TgZ(10,"div",14),e.YNc(11,B,11,12,"ng-container",15),e.YNc(12,D,8,1,"ng-container",2),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("svgIcon","heroicons_solid:x-mark"),e.xp6(4),e.Q6J("disabled",0===t.unreadCount)("matTooltip","Mark all as read"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:envelope-open"),e.xp6(2),e.Q6J("ngForOf",t.messages)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("ngIf",!t.messages||!t.messages.length)}}let L=(()=>{class n{constructor(t,o,i,_){this._changeDetectorRef=t,this._messagesService=o,this._overlay=i,this._viewContainerRef=_,this.unreadCount=0,this._unsubscribeAll=new f.x}ngOnInit(){this._messagesService.messages$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.messages=t,this._calculateUnreadCount(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._overlayRef&&this._overlayRef.dispose()}openPanel(){!this._messagesPanel||!this._messagesOrigin||(this._overlayRef||this._createOverlay(),this._overlayRef.attach(new u.UE(this._messagesPanel,this._viewContainerRef)))}closePanel(){this._overlayRef.detach()}markAllAsRead(){this._messagesService.markAllAsRead().subscribe()}toggleRead(t){t.read=!t.read,this._messagesService.update(t.id,t).subscribe()}delete(t){this._messagesService.delete(t.id).subscribe()}trackByFn(t,o){return o.id||t}_createOverlay(){this._overlayRef=this._overlay.create({hasBackdrop:!0,backdropClass:"fuse-backdrop-on-mobile",scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._messagesOrigin._elementRef.nativeElement).withLockedPosition(!0).withPush(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"}])}),this._overlayRef.backdropClick().subscribe(()=>{this._overlayRef.detach()})}_calculateUnreadCount(){let t=0;this.messages&&this.messages.length&&(t=this.messages.filter(o=>!o.read).length),this.unreadCount=t}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(e.sBO),e.Y36(h.K),e.Y36(v.aV),e.Y36(e.s_b))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["messages"]],viewQuery:function(o,i){if(1&o&&(e.Gf(y,5),e.Gf(M,5)),2&o){let _;e.iGM(_=e.CRH())&&(i._messagesOrigin=_.first),e.iGM(_=e.CRH())&&(i._messagesPanel=_.first)}},exportAs:["messages"],standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[["mat-icon-button","",3,"click"],["messagesOrigin",""],[4,"ngIf"],[3,"svgIcon"],["messagesPanel",""],[1,"absolute","top-0","right-0","left-0","flex","items-center","justify-center","h-3"],[1,"flex","items-center","justify-center","shrink-0","min-w-4","h-4","px-1","ml-4","mt-2.5","rounded-full","bg-indigo-600","text-indigo-50","text-xs","font-medium"],[1,"fixed","inset-0","sm:static","sm:inset-auto","flex","flex-col","sm:min-w-90","sm:w-90","sm:rounded-2xl","overflow-hidden","shadow-lg"],[1,"flex","shrink-0","items-center","py-4","pr-4","pl-6","bg-primary","text-on-primary"],[1,"sm:hidden","-ml-1","mr-3"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"text-lg","font-medium","leading-10"],[1,"ml-auto"],["mat-icon-button","",3,"disabled","matTooltip","click"],[1,"relative","flex","flex-col","flex-auto","sm:max-h-120","divide-y","overflow-y-auto","bg-card"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","group","hover:bg-gray-50","dark:hover:bg-black","dark:hover:bg-opacity-5",3,"ngClass"],[1,"relative","flex","flex-col","my-5","mr-6","ml-2"],["mat-icon-button","",1,"w-6","h-6","min-h-6",3,"matTooltip","click"],[1,"w-2","h-2","rounded-full",3,"ngClass"],["mat-icon-button","",1,"w-6","h-6","min-h-6","sm:opacity-0","sm:group-hover:opacity-100",3,"matTooltip","click"],[1,"icon-size-4",3,"svgIcon"],["messageContent",""],[1,"flex","flex-auto","py-5","pl-6","cursor-pointer",3,"href"],[4,"ngTemplateOutlet"],[1,"flex","flex-auto","py-5","pl-6","cursor-pointer",3,"routerLink"],[1,"flex","flex-auto","py-5","pl-6"],[1,"flex","flex-col","flex-auto"],[1,"mt-2","text-sm","leading-none","text-secondary"],[1,"flex","shrink-0","items-center","justify-center","w-8","h-8","mr-4","rounded-full","bg-gray-100","dark:bg-gray-700"],[1,"icon-size-5",3,"svgIcon"],[1,"shrink-0","w-8","h-8","mr-4","rounded-full","overflow-hidden","object-cover","object-center",3,"src","alt"],[1,"font-semibold","line-clamp-1",3,"innerHTML"],[1,"line-clamp-2",3,"innerHTML"],[1,"flex","flex-col","flex-auto","items-center","justify-center","sm:justify-start","py-12","px-8"],[1,"flex","flex-0","items-center","justify-center","w-14","h-14","rounded-full","bg-primary-100","dark:bg-primary-600"],[1,"text-primary-700","dark:text-primary-50",3,"svgIcon"],[1,"mt-5","text-2xl","font-semibold","tracking-tight"],[1,"w-full","max-w-60","mt-1","text-md","text-center","text-secondary"]],template:function(o,i){1&o&&(e.TgZ(0,"button",0,1),e.NdJ("click",function(){return i.openPanel()}),e.YNc(2,T,4,1,"ng-container",2),e._UZ(3,"mat-icon",3),e.qZA(),e.YNc(4,Y,13,7,"ng-template",null,4,e.W1O)),2&o&&(e.xp6(2),e.Q6J("ngIf",i.unreadCount>0),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:inbox"))},dependencies:[l.ot,l.RK,r.O5,g.Ps,g.Hw,m.AV,m.gM,r.ax,r.mk,r.tP,x.rH,r.uU],encapsulation:2,changeDetection:0})}return n})()}}]);